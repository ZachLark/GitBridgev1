[tox]
envlist = py3
isolated_build = True

[testenv]
deps = -rrequirements-webhook.txt
commands = 
    pytest tests/unit/mas_core/test_redis_queue.py -v --cov=scripts/redis_queue --cov-report=html
    pytest tests/integration/test_redis_queue_integration.py -v
    pytest tests/unit/mas_core/test_consensus.py -v
    pytest tests/unit/mas_core/test_error_handler.py -v
    pytest tests/unit/mas_core/test_metrics.py -v
    pytest tests/unit/mas_core/test_task_chain.py -v
    pytest tests/unit/scripts/test_event_queue.py -v

[pytest]
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
addopts = 
    --verbose
    --showlocals
    --durations=10
    --cov=scripts.redis_queue
    --cov-report=html
    --cov-report=term-missing
    --cov-branch
    --cov-fail-under=80
    --maxfail=1
    --strict-markers
    --strict-config

markers =
    integration: marks tests as integration tests
    slow: marks tests as slow
    redis: marks tests that require Redis
    concurrent: marks tests that test concurrent operations
    error_handling: marks tests that verify error handling
    performance: marks tests that measure performance
    timeout: marks tests with timeout

asyncio_mode = strict
asyncio_default_fixture_loop_scope = function 